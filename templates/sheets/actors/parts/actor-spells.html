{{> "systems/rmss/templates/sheets/actors/parts/search-text.hbs"
id="mod-search-form-actor-spells"
targetSelector=".spell-grid-container [data-search]"
targetDataAttribute="search"
debounce="50"
placeholder="Search spell..."
}}

{{#each spellists as |list|}}
<div class="spell-list-container">
  <div class="spell-list-title">
    <div class="spell-list-name">
      {{list.name}}
      (
      {{#if (eq list.system.type "base")}}
      Base {{list.system.profession}}
      {{else}}
      {{list.system.spell_list_type}} {{list.system.realm}}
      {{/if}}
      )
    </div>
    <span class="spell-list-actions">
      <a class="item-edit" title="Edit Spell List" data-item-id="{{list._id}}">
        <i class="fas fa-edit"></i>
      </a>
      <a class="item-delete" title="Delete Spell List" data-item-id="{{list._id}}">
        <i class="fas fa-trash"></i>
      </a>
    </span>
  </div>

  <div class="spell-grid-container">
    <!-- Column headings -->
    <div class="spell-grid-heading"></div>
    <div class="spell-grid-heading">{{ localize "rmss.pc_sheet_spell.favorite" }}</div>
    <div class="spell-grid-heading">{{ localize "rmss.pc_sheet_spell.name" }}</div>
    <div class="spell-grid-heading">{{ localize "rmss.pc_sheet_spell.area_of_effect" }}</div>
    <div class="spell-grid-heading">{{ localize "rmss.pc_sheet_spell.duration" }}</div>
    <div class="spell-grid-heading">{{ localize "rmss.pc_sheet_spell.range" }}</div>
    <div class="spell-grid-heading">{{ localize "rmss.pc_sheet_spell.type" }}</div>
    <div class="spell-grid-heading"></div>

    <!-- Spells inside the list -->
    {{#each list.contents as |spell|}}
    <div class="spell-row" draggable="true" data-type="Item" data-uuid="Actor.{{list.actorId}}.Item.{{spell._id}}" data-item-id="{{spell._id}}">
    <div data-search="{{spell.name}}">
      <img src="{{spell.img}}" alt="{{spell.name}}" width="32" height="32"/>
    </div>

    {{#if spell.system.favorite}}
    <div data-search="{{spell.name}}">
      <a class="spell-favorite" data-item-id="{{spell._id}}">
        <i class="fa-regular fa-square-check"></i>
      </a>
    </div>
    {{else}}
    <div data-search="{{spell.name}}">
      <a class="spell-favorite" data-item-id="{{spell._id}}">
        <i class="fa-regular fa-square"></i>
      </a>
    </div>
    {{/if}}

    <div data-search="{{spell.name}}" style="display: flex; align-items: center; gap: 0.5em;">
      {{#if (eq spell.system.type "F")}}
      <a class="spell-cast spell-cast-force" title="{{localize 'rmss.spells.cast'}}" data-item-id="{{spell._id}}" data-spell-list-name="{{../name}}" data-spell-list-realm="{{../system.realm}}" data-spell-type="{{spell.system.type}}">
        <i class="fas fa-hand-sparkles"></i> {{spell.name}}{{#if spell.system.instant}}*{{/if}}
      </a>
      {{/if}}
      {{#if (eq spell.system.type "E")}}
      <a class="spell-cast spell-cast-utility" title="{{localize 'rmss.spells.cast'}}" data-item-id="{{spell._id}}" data-spell-list-name="{{../name}}" data-spell-list-realm="{{../system.realm}}" data-spell-type="{{spell.system.type}}">
        <i class="fas fa-magic"></i> {{spell.name}}{{#if spell.system.instant}}*{{/if}}
      </a>
      {{/if}}
      {{#if (eq spell.system.type "P")}}
      <a class="spell-cast spell-cast-utility" title="{{localize 'rmss.spells.cast'}}" data-item-id="{{spell._id}}" data-spell-list-name="{{../name}}" data-spell-list-realm="{{../system.realm}}" data-spell-type="{{spell.system.type}}">
        <i class="fas fa-magic"></i> {{spell.name}}{{#if spell.system.instant}}*{{/if}}
      </a>
      {{/if}}
      {{#if (eq spell.system.type "U")}}
      <a class="spell-cast spell-cast-utility" title="{{localize 'rmss.spells.cast'}}" data-item-id="{{spell._id}}" data-spell-list-name="{{../name}}" data-spell-list-realm="{{../system.realm}}" data-spell-type="{{spell.system.type}}">
        <i class="fas fa-magic"></i> {{spell.name}}{{#if spell.system.instant}}*{{/if}}
      </a>
      {{/if}}
      {{#if (eq spell.system.type "I")}}
      <a class="spell-cast spell-cast-utility" title="{{localize 'rmss.spells.cast'}}" data-item-id="{{spell._id}}" data-spell-list-name="{{../name}}" data-spell-list-realm="{{../system.realm}}" data-spell-type="{{spell.system.type}}">
        <i class="fas fa-magic"></i> {{spell.name}}{{#if spell.system.instant}}*{{/if}}
      </a>
      {{/if}}
      {{#if (eq spell.system.type "BE")}}
      <a class="spell-cast spell-cast-elemental" title="{{localize 'rmss.spells.cast'}}" data-item-id="{{spell._id}}" data-spell-list-name="{{../name}}" data-spell-list-realm="{{../system.realm}}" data-spell-type="{{spell.system.type}}">
        <i class="fa-solid fa-meteor"></i> {{spell.name}}{{#if spell.system.instant}}*{{/if}}
      </a>
      {{/if}}
      {{#if (eq spell.system.type "DE")}}
      <a class="spell-cast spell-cast-directed" title="{{localize 'rmss.spells.cast'}}" data-item-id="{{spell._id}}" data-spell-list-name="{{../name}}" data-spell-list-realm="{{../system.realm}}" data-spell-type="{{spell.system.type}}">
        <i class="fa-solid fa-bolt"></i> {{spell.name}}{{#if spell.system.instant}}*{{/if}}
      </a>
      {{/if}}
      {{#if spell.system.description}}
      <i class="fas fa-info-circle spell-info-icon" 
         data-tooltip="{{spell.system.description}}"></i>
      {{/if}}
    </div>
    <div data-search="{{spell.name}}">{{spell.system.area_of_effect}}</div>
    <div data-search="{{spell.name}}">{{spell.system.duration}}</div>
    <div data-search="{{spell.name}}">{{spell.system.range}}</div>
    <div data-search="{{spell.name}}">{{spell.system.type}}{{#unless (eq spell.system.subType "-")}}{{spell.system.subType}}{{/unless}}</div>
    <div data-search="{{spell.name}}">
      <a class="item-edit" title="Edit Spell" data-item-id="{{spell._id}}">
        <i class="fas fa-edit"></i>
      </a>
      <a class="item-delete" title="Delete Spell" data-item-id="{{spell._id}}">
        <i class="fas fa-trash"></i>
      </a>
    </div>
    </div>
    {{/each}}
  </div>
</div>
{{/each}}
